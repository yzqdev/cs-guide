import{_ as a,c as n,a as e,o as p}from"./app-C8DxhDIZ.js";const t={};function l(o,s){return p(),n("div",null,s[0]||(s[0]=[e(`<h1 id="linux安装postgres" tabindex="-1"><a class="header-anchor" href="#linux安装postgres"><span>linux安装postgres</span></a></h1><h2 id="_1-官网" tabindex="-1"><a class="header-anchor" href="#_1-官网"><span>1. 官网</span></a></h2><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">https://www.postgresql.org/download/linux/ubuntu/</span>
<span class="line"></span></code></pre></div><h2 id="_2-安装" tabindex="-1"><a class="header-anchor" href="#_2-安装"><span>2. 安装</span></a></h2><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">&#39;echo &quot;deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main&quot; &gt; /etc/apt/sources.list.d/pgdg.list&#39;</span></span>
<span class="line"><span class="token function">wget</span> <span class="token parameter variable">--quiet</span> <span class="token parameter variable">-O</span> - https://www.postgresql.org/media/keys/ACCC4CF8.asc <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> postgresql <span class="token comment"># 默认安装最新14</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-初始化账号密码" tabindex="-1"><a class="header-anchor" href="#_3-初始化账号密码"><span>3. 初始化账号密码</span></a></h2><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token parameter variable">-u</span> postgres psql</span>
<span class="line"><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># \\password;</span></span>
<span class="line">please enter password:</span>
<span class="line">please reenter password:</span>
<span class="line"><span class="token comment"># 若要删除该管理员的密码（非必须）</span></span>
<span class="line"><span class="token comment"># sudo -u postgres psql -d postgres</span></span>
<span class="line"></span></code></pre></div><h2 id="_4-配置远程访问" tabindex="-1"><a class="header-anchor" href="#_4-配置远程访问"><span>4. 配置远程访问</span></a></h2><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/postgresql/14/main/postgresql.conf</span>
<span class="line"></span></code></pre></div><p><img src="https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142507326-2131564313.png" alt="img"></p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/postgresql/14/main/pg_hba.conf</span>
<span class="line"></span></code></pre></div><p><img src="https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142622085-560736052.png" alt="img"></p><p>重启服务生效</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl restart postgresql.service</span>
<span class="line"></span></code></pre></div><h3 id="_1-修改linux系统postgres用户的密码" tabindex="-1"><a class="header-anchor" href="#_1-修改linux系统postgres用户的密码"><span>1. 修改linux系统postgres用户的密码</span></a></h3><p>PostgreSQL会创建一个默认的linux用户postgres，修改该用户密码的方法如下：</p><p>步骤一：删除用户postgres的密码</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span><span class="token variable"><span class="token variable">\`</span> <span class="token variable">\`</span></span><span class="token function">passwd</span><span class="token variable"><span class="token variable">\`</span> <span class="token variable">\`</span></span>-d postgre</span>
<span class="line"></span></code></pre></div><p>步骤二：设置用户postgres的密码</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span><span class="token variable"><span class="token variable">\`</span> <span class="token variable">\`</span></span>-u postgres \`\`passwd</span>
<span class="line"></span></code></pre></div><p>系统提示输入新的密码</p><p>Enter new UNIX password:</p><p>Retype new UNIX password:</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">passwd\`\`: password updated successfully</span>
<span class="line"></span></code></pre></div><h3 id="_2-修改postgresql数据库默认用户postgres的密码" tabindex="-1"><a class="header-anchor" href="#_2-修改postgresql数据库默认用户postgres的密码"><span>2. 修改PostgreSQL数据库默认用户postgres的密码</span></a></h3><p>PostgreSQL数据库创建一个postgres用户作为数据库的管理员，密码随机，所以需要修改密码，方式如下：</p><p>步骤一：登录PostgreSQL</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span><span class="token variable"><span class="token variable">\`</span> <span class="token variable">\`</span></span>-u postgres psql</span>
<span class="line"></span></code></pre></div><p>步骤二：修改登录PostgreSQL密码</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">ALTER <span class="token environment constant">USER</span> postgres WITH PASSWORD \`<span class="token variable"><span class="token variable">\`</span>&#39;postgres&#39;<span class="token variable">\`</span></span>\`<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre></div><p><strong>注：</strong></p><ul><li>密码postgres要用引号引起来</li><li>命令最后有分号 \\5. 测试远程访问，输入之前修改的密码即可</li></ul><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">master@master:~$ psql <span class="token parameter variable">-U</span> postgres <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.10.248 </span>
<span class="line">Password <span class="token keyword">for</span> user postgres: </span>
<span class="line">psql <span class="token punctuation">(</span><span class="token number">13.5</span> <span class="token punctuation">(</span>Ubuntu <span class="token number">13.5</span>-1.pgdg18.04+1<span class="token punctuation">)</span>, server <span class="token number">14.1</span> <span class="token punctuation">(</span>Ubuntu <span class="token number">14.1</span>-1.pgdg18.04+1<span class="token punctuation">))</span></span>
<span class="line">WARNING: psql major version <span class="token number">13</span>, server major version <span class="token number">14</span>.</span>
<span class="line">         Some psql features might not work.</span>
<span class="line">SSL connection <span class="token punctuation">(</span>protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: <span class="token number">256</span>, compression: off<span class="token punctuation">)</span></span>
<span class="line">Type <span class="token string">&quot;help&quot;</span> <span class="token keyword">for</span> help.</span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># </span></span>
<span class="line"></span></code></pre></div><p>\\6. 常用操作</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> systemctl restart postgresql.service</span>
<span class="line"><span class="token function">sudo</span> systemctl start postgresql.service</span>
<span class="line"><span class="token function">sudo</span> systemctl stop postgresql.service</span>
<span class="line"><span class="token function">sudo</span> systemctl status postgresql.service</span>
<span class="line"><span class="token comment"># or</span></span>
<span class="line"><span class="token function">sudo</span> /etc/init.d/postgresql status</span>
<span class="line"><span class="token function">sudo</span> /etc/init.d/postgresql start</span>
<span class="line"><span class="token function">sudo</span> /etc/init.d/postgresql stop</span>
<span class="line"><span class="token function">sudo</span> /etc/init.d/postgresql restart</span>
<span class="line"><span class="token comment"># or</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> postgresql restart</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> postgresql start</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> postgresql stop</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> postgresql status</span>
<span class="line"></span></code></pre></div><p>\\6. 卸载</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">tester@fabu:~$ <span class="token function">sudo</span> dpkg --get-selections <span class="token operator">|</span> <span class="token function">grep</span> postgres  <span class="token comment"># 或者sudo dpkg -l | grep postgres</span></span>
<span class="line">postgresql                                      <span class="token function">install</span></span>
<span class="line">postgresql-14                                   <span class="token function">install</span></span>
<span class="line">postgresql-client-14                            <span class="token function">install</span></span>
<span class="line">postgresql-client-common                        <span class="token function">install</span></span>
<span class="line">postgresql-common                               <span class="token function">install</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> postgresql stop </span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">--purge</span> remove postgresql<span class="token punctuation">\\</span>*</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> /etc/postgresql/</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> /etc/postgresql-common/</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> /var/lib/postgresql/</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">userdel</span> <span class="token parameter variable">-r</span> postgres</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">groupdel</span> postgres</span>
<span class="line"></span></code></pre></div><p>配置密码</p><p>如何安全地修改密码：</p><p>方式1 使用psql，连接到Postgres Server：</p><p>test1=&gt; \\password Enter new password: Enter it again: test1=&gt; 我将原密码hello，修改为hellojava.123456 这种修改方式相当于向postgres server 发送了如下命令：</p><p>ALTER USER postgres PASSWORD &#39; md53175af154as54df5as4d5f45sd6af&#39;; 后面的字符串是 hellojava经过md5加密后的字符串 12345 注意：尽量不要使用postgres作为用户密码，防止被攻击。</p><p>方式2：可以直接发送sql修改：</p><p>\`这种方式不仅仅限于psql了，其余客户端也能修改，如pgadmin等</p><p>ALTER USER test1 PASSWORD &#39;secret&#39; 弊端：通过sql修改，有可能会将修改语句记录在相关工具的log里。 例如：通过psql 运行该条sql，则在.psql_history文件中会有相应语句的记录 有密码泄露的风险</p><h2 id="常见错误" tabindex="-1"><a class="header-anchor" href="#常见错误"><span>常见错误</span></a></h2><h3 id="连接pg数据库报错-no-pg-hba-conf-entry-for-host" tabindex="-1"><a class="header-anchor" href="#连接pg数据库报错-no-pg-hba-conf-entry-for-host"><span>连接pg数据库报错：no pg_hba.conf entry for host</span></a></h3><p>解决办法： 修改pg_hba.conf，在第一行添加一行： host all all 0.0.0.0/0 md5 表示允许任何用户连接到任何数据库，用一个加密的密码</p>`,48)]))}const i=a(t,[["render",l]]),r=JSON.parse('{"path":"/java-tutor/orm-tutor/pgsql/psql-linux.html","title":"linux安装postgres","lang":"zh-CN","frontmatter":{"description":"linux安装postgres 1. 官网 2. 安装 3. 初始化账号密码 4. 配置远程访问 img img 重启服务生效 1. 修改linux系统postgres用户的密码 PostgreSQL会创建一个默认的linux用户postgres，修改该用户密码的方法如下： 步骤一：删除用户postgres的密码 步骤二：设置用户postgres的密码...","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/java-tutor/orm-tutor/pgsql/psql-linux.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"linux安装postgres"}],["meta",{"property":"og:description","content":"linux安装postgres 1. 官网 2. 安装 3. 初始化账号密码 4. 配置远程访问 img img 重启服务生效 1. 修改linux系统postgres用户的密码 PostgreSQL会创建一个默认的linux用户postgres，修改该用户密码的方法如下： 步骤一：删除用户postgres的密码 步骤二：设置用户postgres的密码..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142507326-2131564313.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-04-30T14:30:26.000Z"}],["meta",{"property":"article:modified_time","content":"2023-04-30T14:30:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"linux安装postgres\\",\\"image\\":[\\"https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142507326-2131564313.png\\",\\"https://img2020.cnblogs.com/blog/1586673/202112/1586673-20211228142622085-560736052.png\\"],\\"dateModified\\":\\"2023-04-30T14:30:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yzqdev\\",\\"url\\":\\"http://www.yzqdev.top\\"}]}"]]},"headers":[{"level":2,"title":"1. 官网","slug":"_1-官网","link":"#_1-官网","children":[]},{"level":2,"title":"2. 安装","slug":"_2-安装","link":"#_2-安装","children":[]},{"level":2,"title":"3. 初始化账号密码","slug":"_3-初始化账号密码","link":"#_3-初始化账号密码","children":[]},{"level":2,"title":"4. 配置远程访问","slug":"_4-配置远程访问","link":"#_4-配置远程访问","children":[{"level":3,"title":"1. 修改linux系统postgres用户的密码","slug":"_1-修改linux系统postgres用户的密码","link":"#_1-修改linux系统postgres用户的密码","children":[]},{"level":3,"title":"2. 修改PostgreSQL数据库默认用户postgres的密码","slug":"_2-修改postgresql数据库默认用户postgres的密码","link":"#_2-修改postgresql数据库默认用户postgres的密码","children":[]}]},{"level":2,"title":"常见错误","slug":"常见错误","link":"#常见错误","children":[{"level":3,"title":"连接pg数据库报错：no pg_hba.conf entry for host","slug":"连接pg数据库报错-no-pg-hba-conf-entry-for-host","link":"#连接pg数据库报错-no-pg-hba-conf-entry-for-host","children":[]}]}],"git":{"createdTime":1652480641000,"updatedTime":1682865026000,"contributors":[{"name":"yzqdev","username":"yzqdev","email":"yzqdev@outlook.com","commits":4,"url":"https://github.com/yzqdev"}]},"readingTime":{"minutes":2.57,"words":771},"filePathRelative":"java-tutor/orm-tutor/pgsql/psql-linux.md","localizedDate":"2022年5月13日","autoDesc":true}');export{i as comp,r as data};
