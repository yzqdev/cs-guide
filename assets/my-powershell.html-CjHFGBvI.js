import{_ as s,c as a,a as p,o as e}from"./app-C8DxhDIZ.js";const t={};function l(i,n){return e(),a("div",null,n[0]||(n[0]=[p(`<h1 id="我的ps配置" tabindex="-1"><a class="header-anchor" href="#我的ps配置"><span>我的ps配置</span></a></h1><div class="hint-container tip"><p class="hint-container-title">提示</p><p>查询 <code>profile</code>位置: <code>$PROFILE</code></p></div><h2 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件"><span>配置文件</span></a></h2><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token keyword">function</span> fluship <span class="token punctuation">{</span></span>
<span class="line">    ipconfig <span class="token operator">/</span>flushdns</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> yarnDev <span class="token punctuation">{</span></span>
<span class="line">    yarn <span class="token operator">--</span>registry=https:<span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>npmmirror<span class="token punctuation">.</span>com &amp;&amp; yarn dev</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> yarnInstall <span class="token punctuation">{</span></span>
<span class="line">    yarn install <span class="token operator">--</span>registry=https:<span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>npmmirror<span class="token punctuation">.</span>com</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> removeItem <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>Force</span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> getCmdPath<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">start</span> <span class="token punctuation">(</span><span class="token function">Get-ChildItem</span> <span class="token punctuation">(</span><span class="token function">Get-Command</span> <span class="token operator">-</span>Name <span class="token variable">$args</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Source<span class="token punctuation">)</span><span class="token punctuation">.</span>Directory</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> deletePnpm <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Copy-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json <span class="token operator">-</span>Destination <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>jsonbak<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token string">&quot;pnpm-lock.yml&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Remove-Item</span>  <span class="token string">&quot;pnpm-lock.yml&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">Write-Output</span> <span class="token string">&#39;删除node_modules中&#39;</span></span>
<span class="line">    pnpm init &amp;&amp; pnpm add axios</span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token operator">-</span>Force <span class="token operator">-</span>Recurse <span class="token punctuation">.</span>\\node_modules<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Copy-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>jsonbak <span class="token operator">-</span>Destination <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>jsonbak</span>
<span class="line">    <span class="token comment"># 删除文件名中包含lock字符的文件</span></span>
<span class="line">    <span class="token function">Remove-Item</span>   <span class="token string">&#39;*lock*&#39;</span></span>
<span class="line">    <span class="token function">Write-Output</span> <span class="token string">&#39;已完成&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> deleteNodemodules <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Copy-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json <span class="token operator">-</span>Destination <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>jsonbak<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Write-Output</span> <span class="token string">&#39;删除node_modules中&#39;</span></span>
<span class="line">    yarn init <span class="token operator">-</span>y &amp;&amp; yarn add axios<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token operator">-</span>Force <span class="token operator">-</span>Recurse <span class="token punctuation">.</span>\\node_modules<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Copy-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>jsonbak <span class="token operator">-</span>Destination <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>json<span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token punctuation">.</span>\\package<span class="token punctuation">.</span>jsonbak</span>
<span class="line">    <span class="token comment"># 删除文件名中包含lock字符的文件</span></span>
<span class="line">    <span class="token function">Remove-Item</span>   <span class="token string">&#39;*lock*&#39;</span></span>
<span class="line">    <span class="token function">Write-Output</span> <span class="token string">&#39;已完成&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> gbFun <span class="token punctuation">{</span></span>
<span class="line">    git pull <span class="token operator">--</span>rebase</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> glogFun <span class="token punctuation">{</span></span>
<span class="line">    git log <span class="token operator">--</span>graph <span class="token operator">--</span>pretty=<span class="token string">&#39;%Cred%h%Creset -%C(auto)%d%Creset %s %Cgreen(%ar) %C(bold blue)&lt;%an&gt;%Creset&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> gpFunc <span class="token punctuation">{</span></span>
<span class="line">    git add <span class="token operator">-</span>A &amp;&amp; git commit <span class="token operator">-</span>m <span class="token variable">$args</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span> &amp;&amp; git push origin main</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> gcacheFun <span class="token punctuation">{</span></span>
<span class="line">    git checkout <span class="token operator">--</span>orphan dev <span class="token punctuation">;</span></span>
<span class="line">    git add <span class="token operator">-</span>A <span class="token punctuation">;</span></span>
<span class="line">    git branch <span class="token operator">-</span>D main <span class="token punctuation">;</span></span>
<span class="line">    git branch <span class="token operator">-</span>m main <span class="token punctuation">;</span></span>
<span class="line">    git commit <span class="token operator">-</span>m <span class="token string">&#39;Initial commit&#39;</span> <span class="token punctuation">;</span></span>
<span class="line">    git push origin main <span class="token operator">-</span>f <span class="token punctuation">;</span></span>
<span class="line">    git <span class="token function">gc</span> <span class="token operator">--</span>aggressive <span class="token operator">--</span>prune=all</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Format-FileSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">Param</span> <span class="token punctuation">(</span><span class="token namespace">[int]</span><span class="token variable">$size</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">If</span> <span class="token punctuation">(</span><span class="token variable">$size</span> <span class="token operator">-gt</span> 1TB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token namespace">[string]</span>::Format<span class="token punctuation">(</span><span class="token string">&quot;{0:0.00} TB&quot;</span><span class="token punctuation">,</span> <span class="token variable">$size</span> <span class="token operator">/</span> 1TB<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">ElseIf</span> <span class="token punctuation">(</span><span class="token variable">$size</span> <span class="token operator">-gt</span> 1GB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token namespace">[string]</span>::Format<span class="token punctuation">(</span><span class="token string">&quot;{0:0.00} GB&quot;</span><span class="token punctuation">,</span> <span class="token variable">$size</span> <span class="token operator">/</span> 1GB<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">ElseIf</span> <span class="token punctuation">(</span><span class="token variable">$size</span> <span class="token operator">-gt</span> 1MB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token namespace">[string]</span>::Format<span class="token punctuation">(</span><span class="token string">&quot;{0:0.00} MB&quot;</span><span class="token punctuation">,</span> <span class="token variable">$size</span> <span class="token operator">/</span> 1MB<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">ElseIf</span> <span class="token punctuation">(</span><span class="token variable">$size</span> <span class="token operator">-gt</span> 1KB<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token namespace">[string]</span>::Format<span class="token punctuation">(</span><span class="token string">&quot;{0:0.00} kB&quot;</span><span class="token punctuation">,</span> <span class="token variable">$size</span> <span class="token operator">/</span> 1KB<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">ElseIf</span> <span class="token punctuation">(</span><span class="token variable">$size</span> <span class="token operator">-gt</span> 0<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token namespace">[string]</span>::Format<span class="token punctuation">(</span><span class="token string">&quot;{0:0.00} B&quot;</span><span class="token punctuation">,</span> <span class="token variable">$size</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">Else</span> <span class="token punctuation">{</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> lsmFunc<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Get-ChildItem</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> Name<span class="token punctuation">,</span> LastWriteTime<span class="token punctuation">,</span> @<span class="token punctuation">{</span>Name = <span class="token string">&quot;Size&quot;</span><span class="token punctuation">;</span> Expression = <span class="token punctuation">{</span> <span class="token function">Format-FileSize</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>Length<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment"># # PowerShell parameter completion shim for the dotnet CLI</span></span>
<span class="line"><span class="token function">Register-ArgumentCompleter</span> <span class="token operator">-</span>Native <span class="token operator">-</span>CommandName dotnet <span class="token operator">-</span>ScriptBlock <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">param</span><span class="token punctuation">(</span><span class="token variable">$commandName</span><span class="token punctuation">,</span> <span class="token variable">$wordToComplete</span><span class="token punctuation">,</span> <span class="token variable">$cursorPosition</span><span class="token punctuation">)</span></span>
<span class="line">    dotnet complete <span class="token operator">--</span>position <span class="token variable">$cursorPosition</span> <span class="token string">&quot;<span class="token variable">$wordToComplete</span>&quot;</span> <span class="token punctuation">|</span> <span class="token function">ForEach-Object</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token namespace">[System.Management.Automation.CompletionResult]</span>::new<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">,</span> <span class="token variable">$_</span><span class="token punctuation">,</span> <span class="token string">&#39;ParameterValue&#39;</span><span class="token punctuation">,</span> <span class="token variable">$_</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">Remove-Alias</span> <span class="token operator">-</span>Name <span class="token function">ni</span> <span class="token operator">-</span>Force</span>
<span class="line"><span class="token function">Set-Alias</span> yr deleteNodemodules</span>
<span class="line"><span class="token function">Set-Alias</span> pr deletePnpm</span>
<span class="line"><span class="token function">Set-Alias</span> ip fluship</span>
<span class="line"><span class="token function">Set-Alias</span> yd yarnDev</span>
<span class="line"><span class="token function">Set-Alias</span> y yarnInstall</span>
<span class="line"><span class="token function">Set-Alias</span> gitp gpFunc</span>
<span class="line"><span class="token function">Set-Alias</span> gitc gcacheFunq</span>
<span class="line"><span class="token function">Set-Alias</span> gcp getCmdPath</span>
<span class="line"><span class="token function">Set-Alias</span> gb gbFun</span>
<span class="line"><span class="token function">Set-Alias</span> glog glogFun</span>
<span class="line"><span class="token function">Set-Alias</span> kate <span class="token string">&quot;C:\\Program Files\\Kate\\bin\\kate.exe&quot;</span></span>
<span class="line"><span class="token function">Set-Alias</span> lsm lsmFunc</span>
<span class="line"><span class="token comment"># #chcp 65001</span></span>
<span class="line"><span class="token comment"># #chcp 936</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$env</span>:TERM_PROGRAM <span class="token operator">-eq</span> <span class="token string">&quot;vscode&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">.</span> <span class="token string">&quot;<span class="token variable">$env</span>:USERPROFILE\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\out\\vs\\workbench\\contrib\\terminal\\browser\\media\\shellIntegration.ps1&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment"># if ($env:TERM_PROGRAM -eq &quot;vscode&quot;) { . &quot;$(code --locate-shell-integration-path pwsh)&quot; }</span></span>
<span class="line"><span class="token comment"># # PSReadLine</span></span>
<span class="line"><span class="token function">Import-Module</span> PSReadLine</span>
<span class="line"><span class="token function">Import-Module</span> <span class="token operator">-</span>Name Terminal-Icons</span>
<span class="line"><span class="token comment"># # Enable Prediction History</span></span>
<span class="line"><span class="token function">Set-PSReadLineOption</span> <span class="token operator">-</span>PredictionSource History</span>
<span class="line"><span class="token comment"># # Advanced Autocompletion for arrow keys</span></span>
<span class="line"><span class="token function">Set-PSReadlineKeyHandler</span> <span class="token operator">-</span>Key UpArrow <span class="token operator">-</span><span class="token keyword">Function</span> HistorySearchBackward</span>
<span class="line"><span class="token function">Set-PSReadlineKeyHandler</span> <span class="token operator">-</span>Key DownArrow <span class="token operator">-</span><span class="token keyword">Function</span> HistorySearchForward</span>
<span class="line"><span class="token function">Import-Module</span> posh-git</span>
<span class="line">oh-my-posh init pwsh <span class="token operator">--</span>config <span class="token string">&quot;<span class="token variable">$env</span>:POSH_THEMES_PATH\\negligible.omp.json&quot;</span> <span class="token punctuation">|</span> <span class="token function">Invoke-Expression</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># #conda activate condapkg</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="克隆王道的文档" tabindex="-1"><a class="header-anchor" href="#克隆王道的文档"><span>克隆王道的文档</span></a></h2><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token variable">$prefix</span> = <span class="token string">&#39;https://github.com/wangdoc/&#39;</span></span>
<span class="line"><span class="token variable">$suffix</span> = <span class="token string">&#39;.git&#39;</span></span>
<span class="line"><span class="token variable">$cur</span> = <span class="token variable">$PWD</span></span>
<span class="line"><span class="token variable">$gitRepos</span> = <span class="token string">&#39;bash-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;git-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;node-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;javascript-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;clang-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;css-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;es6-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ssh-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;html-tutorial&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;webapi-tutorial&#39;</span></span>
<span class="line"><span class="token comment"># 这里填你的docs文件夹</span></span>
<span class="line"> </span>
<span class="line"><span class="token variable">$dest</span> = <span class="token string">&#39;E:\\myblogs\\wangdoc\\docs\\&#39;</span></span>
<span class="line"><span class="token comment"># 系统临时文件路径</span></span>
<span class="line"><span class="token variable">$tmpPath</span> = <span class="token variable">$env</span>:tmp <span class="token operator">+</span> <span class="token string">&#39;\\wang\\&#39;</span></span>
<span class="line"><span class="token function">Write-Host</span>  <span class="token string">&#39;设置临时文件路径&#39;</span><span class="token variable">$tmpPath</span> <span class="token operator">-</span>ForegroundColor Cyan</span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-not</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token variable">$tmpPath</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    mkdir <span class="token variable">$tmpPath</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">Set-Location</span> <span class="token variable">$tmpPath</span></span>
<span class="line"><span class="token comment"># 克隆所有文件</span></span>
<span class="line"><span class="token keyword">function</span> cloneAll <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$item</span> in <span class="token variable">$gitRepos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        git clone <span class="token variable">$prefix</span><span class="token variable">$item</span><span class="token variable">$suffix</span></span>
<span class="line">        <span class="token function">Set-Location</span> <span class="token variable">$item</span></span>
<span class="line">        <span class="token function">Copy-Item</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>Force docs <span class="token variable">$dest</span><span class="token variable">$item</span></span>
<span class="line">    <span class="token punctuation">}</span> </span>
<span class="line">    <span class="token function">Set-Location</span> <span class="token variable">$cur</span></span>
<span class="line">    delTmpPath</span>
<span class="line">    </span>
<span class="line">    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> cloneOnlyDocs <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$item</span> in <span class="token variable">$gitRepos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-not</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span>  <span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            mkdir <span class="token variable">$item</span> </span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        </span>
<span class="line">         </span>
<span class="line">        <span class="token function">Set-Location</span> <span class="token variable">$item</span></span>
<span class="line">    </span>
<span class="line">        <span class="token function">Write-Host</span> <span class="token string">&#39;当前路径&#39;</span><span class="token variable">$PWD</span> <span class="token operator">-</span>ForegroundColor Cyan</span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token string">&quot;.git&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">Write-Host</span>  <span class="token string">&#39;已有git文件夹&#39;</span> <span class="token operator">-</span>ForegroundColor Cyan</span>
<span class="line">            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">&#39;ssh-tutorial&#39;</span> <span class="token punctuation">{</span>  </span>
<span class="line">                    git pull origin main</span>
<span class="line">                <span class="token punctuation">}</span> </span>
<span class="line">                <span class="token string">&#39;clang-tutorial&#39;</span> <span class="token punctuation">{</span>  </span>
<span class="line">                    git pull origin main</span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                Default <span class="token punctuation">{</span></span>
<span class="line">                    git pull origin master</span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token function">Write-Host</span> <span class="token string">&#39;从docs复制到&#39;</span><span class="token variable">$dest</span><span class="token variable">$item</span> <span class="token operator">-</span>ForegroundColor Cyan</span>
<span class="line">            <span class="token comment"># 注意下面的\\文件夹分割</span></span>
<span class="line">            <span class="token function">Copy-Item</span>  <span class="token operator">-</span>Path <span class="token string">&#39;docs&#39;</span><span class="token operator">-</span>Destination  <span class="token variable">$dest</span><span class="token variable">$item</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>Force</span>
<span class="line">            <span class="token function">Set-Location</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            git init</span>
<span class="line">            git remote add origin <span class="token variable">$prefix</span><span class="token variable">$item</span><span class="token variable">$suffix</span></span>
<span class="line">            <span class="token comment"># 设置允许克隆子目录</span></span>
<span class="line">            git config core<span class="token punctuation">.</span>sparsecheckout true </span>
<span class="line">            <span class="token function">Write-Host</span>  <span class="token string">&#39;没有git文件夹,正在克隆&#39;</span> <span class="token operator">-</span>ForegroundColor Cyan</span>
<span class="line">            <span class="token function">Write-Host</span> <span class="token string">&#39;当前路径&#39;</span><span class="token variable">$PWD</span> <span class="token operator">-</span>ForegroundColor Cyan</span>
<span class="line">            <span class="token function">Write-Output</span> <span class="token string">&#39;docs&#39;</span> &gt;&gt; <span class="token string">&#39;.git/info/sparse-checkout&#39;</span>  </span>
<span class="line">            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">&#39;ssh-tutorial&#39;</span> <span class="token punctuation">{</span>  </span>
<span class="line">                    git pull origin main</span>
<span class="line">                <span class="token punctuation">}</span> </span>
<span class="line">                <span class="token string">&#39;clang-tutorial&#39;</span> <span class="token punctuation">{</span>  </span>
<span class="line">                    git pull origin main</span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                Default <span class="token punctuation">{</span></span>
<span class="line">                    git pull origin master</span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token comment"># 注意下面的\\文件夹分割 -Force 覆盖文件</span></span>
<span class="line">            <span class="token function">Copy-Item</span>  <span class="token operator">-</span>Path <span class="token string">&#39;docs&#39;</span>  <span class="token operator">-</span>Destination  <span class="token variable">$dest</span><span class="token variable">$item</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>Force</span>
<span class="line">            <span class="token function">Set-Location</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> </span>
<span class="line">     </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> delTmpPath <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Remove-Item</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>Force <span class="token variable">$tmpPath</span></span>
<span class="line">    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">cloneOnlyDocs</span>
<span class="line"><span class="token function">Set-Location</span> <span class="token variable">$cur</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="小爬虫" tabindex="-1"><a class="header-anchor" href="#小爬虫"><span>小爬虫</span></a></h2><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token comment">#This is a crawler for baidu images</span></span>
<span class="line"><span class="token comment">&lt;#</span>
<span class="line">All these funuctions would be used to implementation crawler&#39;s target</span>
<span class="line">#&gt;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Get-Random</span><span class="token operator">-</span>String <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$fileName</span> = <span class="token operator">-join</span> <span class="token punctuation">(</span><span class="token namespace">[char[]]</span><span class="token punctuation">(</span>65<span class="token punctuation">.</span><span class="token punctuation">.</span>90 <span class="token operator">+</span> 97<span class="token punctuation">.</span><span class="token punctuation">.</span>122<span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Get-Random</span> <span class="token operator">-</span>Count 6<span class="token punctuation">)</span></span>
<span class="line">    <span class="token variable">$fileName</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Resolve-Directory</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">param</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token namespace">[Parameter(Mandatory)]</span></span>
<span class="line">        <span class="token namespace">[string]</span></span>
<span class="line">        <span class="token variable">$Path</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-not</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token operator">-</span>LiteralPath <span class="token variable">$Path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">New-Item</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span> <span class="token operator">-</span>ItemType Directory <span class="token operator">-</span>ErrorAction SilentlyContinue</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> Invoke-MD5 <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">param</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token comment"># Parameter Path</span></span>
<span class="line">        <span class="token namespace">[Parameter(Mandatory)]</span></span>
<span class="line">        <span class="token namespace">[string]</span></span>
<span class="line">        <span class="token variable">$Path</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">begin</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$global</span>:hashTable = @<span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">process</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span> <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$hash</span> = <span class="token function">Get-FileHash</span> <span class="token operator">-</span>Path <span class="token variable">$_</span><span class="token punctuation">.</span>FullName <span class="token operator">-</span>Algorithm MD5</span>
<span class="line">            <span class="token variable">$hashTable</span><span class="token punctuation">[</span><span class="token variable">$hash</span><span class="token punctuation">.</span>Hash<span class="token punctuation">]</span> = <span class="token variable">$hash</span><span class="token punctuation">.</span>Path</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">end</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Get-Images</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">param</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token namespace">[Parameter(ValueFromPipeline)]</span></span>
<span class="line">        <span class="token namespace">[int]</span></span>
<span class="line">        <span class="token variable">$page</span> = 1<span class="token punctuation">,</span></span>
<span class="line">        <span class="token namespace">[Parameter(Mandatory)]</span></span>
<span class="line">        <span class="token namespace">[string]</span></span>
<span class="line">        <span class="token variable">$Path</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token namespace">[Parameter(Mandatory)]</span></span>
<span class="line">        <span class="token namespace">[string]</span></span>
<span class="line">        <span class="token variable">$keyword</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">begin</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Resolve-Directory</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span></span>
<span class="line">        Invoke-MD5 <span class="token operator">-</span>Path <span class="token variable">$Path</span></span>
<span class="line">        <span class="token variable">$headers</span> = @<span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">&#39;Accept&#39;</span>                    = <span class="token string">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&#39;</span></span>
<span class="line">            <span class="token string">&#39;Accept-Encoding&#39;</span>           = <span class="token string">&#39;gzip, deflate, br&#39;</span></span>
<span class="line">            <span class="token string">&#39;Accept-Language&#39;</span>           = <span class="token string">&#39;en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7&#39;</span></span>
<span class="line">            <span class="token string">&#39;Host&#39;</span>                      = <span class="token string">&#39;image.baidu.com&#39;</span></span>
<span class="line">            <span class="token string">&#39;Upgrade-Insecure-Requests&#39;</span> = <span class="token string">&#39;1&#39;</span></span>
<span class="line">            <span class="token string">&#39;User-Agent&#39;</span>                = <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36&#39;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">process</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$n</span> = <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">*</span> 20<span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$word</span> = <span class="token namespace">[uri]</span>::EscapeDataString<span class="token punctuation">(</span><span class="token variable">$keyword</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$url</span> = <span class="token string">&quot;https://image.baidu.com/search/flip?tn=baiduimage&amp;ie=utf-8&amp;word=\${word}&amp;pn=<span class="token variable">$n</span>&quot;</span></span>
<span class="line">        <span class="token function">Write-Host</span> <span class="token string">&quot;Handling <span class="token variable">$url</span>\`n&quot;</span></span>
<span class="line">        <span class="token variable">$web</span> = <span class="token punctuation">(</span><span class="token function">Invoke-WebRequest</span> <span class="token operator">-</span>Uri <span class="token variable">$url</span> <span class="token operator">-</span>Method GET <span class="token operator">-</span>Headers <span class="token variable">$headers</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$web</span> <span class="token punctuation">|</span> <span class="token function">Select-String</span> <span class="token string">&#39;&quot;objURL&quot;:&quot;https?://+[^\\s]+[\\w]&#39;</span> <span class="token operator">-</span>AllMatches <span class="token punctuation">|</span> <span class="token function">ForEach-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>Matches <span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Foreach-Object</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$_</span> <span class="token operator">-match</span> <span class="token string">&#39;https?://.+.&#39;</span></span>
<span class="line">            <span class="token variable">$Matches</span><span class="token punctuation">.</span>Values <span class="token punctuation">|</span> <span class="token function">ForEach-Object</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">Write-Host</span> <span class="token string">&quot;Fetching from <span class="token variable">$_</span>&quot;</span> <span class="token operator">-</span>ForegroundColor 3</span>
<span class="line">                <span class="token variable">$ext</span> = <span class="token punctuation">(</span><span class="token namespace">[regex]</span><span class="token string">&#39;\\.(jpe?g|png|gif|tif|bmp)&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Match<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value</span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token namespace">[String]</span>::IsNullOrEmpty<span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$ext</span> = <span class="token string">&quot;.jpg&quot;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token variable">$fileFullName</span> = <span class="token punctuation">(</span><span class="token function">Get-Random</span><span class="token operator">-</span>String<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token variable">$ext</span></span>
<span class="line">                <span class="token variable">$TargetPath</span> = <span class="token function">Join-Path</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span> <span class="token operator">-</span>ChildPath <span class="token variable">$fileFullName</span></span>
<span class="line">                <span class="token function">Invoke-WebRequest</span> <span class="token operator">-</span>Uri <span class="token variable">$_</span> <span class="token operator">-</span>PassThru <span class="token operator">-</span>TimeoutSec 20000 <span class="token operator">-</span>OutFile <span class="token variable">$TargetPath</span> <span class="token operator">-</span>ErrorAction SilentlyContinue</span>
<span class="line">                <span class="token comment"># calculate the md5 value</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token variable">$TargetPath</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$hashValue</span> = <span class="token punctuation">(</span><span class="token function">Get-FileHash</span> <span class="token operator">-</span>Path <span class="token variable">$TargetPath</span> <span class="token operator">-</span>Algorithm MD5<span class="token punctuation">)</span><span class="token punctuation">.</span>Hash</span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$hashValue</span> <span class="token operator">-and</span> <span class="token variable">$hashTable</span><span class="token punctuation">.</span>ContainsKey<span class="token punctuation">(</span><span class="token variable">$hashValue</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token function">Remove-Item</span> <span class="token operator">-</span>Path <span class="token variable">$TargetPath</span> <span class="token operator">-</span>Force <span class="token operator">-</span>ErrorAction SilentlyContinue</span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token function">Start-Sleep</span> <span class="token operator">-</span>Milliseconds 1000</span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">#ii $Path</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">0<span class="token punctuation">.</span><span class="token punctuation">.</span>10 <span class="token punctuation">|</span> <span class="token function">Get-Images</span> <span class="token operator">-</span>Path <span class="token string">&quot;d:\\temp\\baiduimages&quot;</span> <span class="token operator">-</span>keyword <span class="token string">&quot;soft cat&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="获取安装的软件" tabindex="-1"><a class="header-anchor" href="#获取安装的软件"><span>获取安装的软件</span></a></h2><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token comment">&lt;#</span>
<span class="line">.Synopsis</span>
<span class="line">   Get installed software list by retrieving registry.</span>
<span class="line">.DESCRIPTION</span>
<span class="line">   The function return a installed software list by retrieving registry from below path;</span>
<span class="line">   1.&#39;HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall&#39;</span>
<span class="line">   2.&#39;HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall&#39;</span>
<span class="line">   3.&#39;HKLM:SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall&#39;</span>
<span class="line">   Author: Mosser Lee (http://www.pstips.net/author/mosser/)</span>
<span class="line"></span>
<span class="line">.EXAMPLE</span>
<span class="line">   Get-InstalledSoftwares</span>
<span class="line">.EXAMPLE</span>
<span class="line">   Get-InstalledSoftwares  | Group-Object Publisher</span>
<span class="line">#&gt;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Get-InstalledSoftwares</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token comment"># Read registry key as product entity.</span></span>
<span class="line">    <span class="token comment">#</span></span>
<span class="line">    <span class="token keyword">function</span> <span class="token function">ConvertTo-ProductEntity</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">param</span><span class="token punctuation">(</span><span class="token namespace">[Microsoft.Win32.RegistryKey]</span><span class="token variable">$RegKey</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$product</span> = <span class="token string">&#39;&#39;</span> <span class="token punctuation">|</span> <span class="token function">select</span> Name<span class="token punctuation">,</span> Publisher<span class="token punctuation">,</span> Version</span>
<span class="line">        <span class="token variable">$product</span><span class="token punctuation">.</span>Name = <span class="token variable">$_</span><span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token string">&quot;DisplayName&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$product</span><span class="token punctuation">.</span>Publisher = <span class="token variable">$_</span><span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token string">&quot;Publisher&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$product</span><span class="token punctuation">.</span>Version = <span class="token variable">$_</span><span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token string">&quot;DisplayVersion&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">-not</span> <span class="token namespace">[string]</span>::IsNullOrEmpty<span class="token punctuation">(</span><span class="token variable">$product</span><span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$product</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$UninstallPaths</span> = @<span class="token punctuation">(</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token comment"># For local machine.</span></span>
<span class="line">        <span class="token string">&#39;HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token comment"># For current user.</span></span>
<span class="line">        <span class="token string">&#39;HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># For 32bit softwares that were installed on 64bit operating system.</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token namespace">[Environment]</span>::Is64BitOperatingSystem<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$UninstallPaths</span> <span class="token operator">+=</span> <span class="token string">&#39;HKLM:SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token variable">$UninstallPaths</span> <span class="token punctuation">|</span> <span class="token keyword">foreach</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Get-ChildItem</span> <span class="token variable">$_</span> <span class="token punctuation">|</span> <span class="token keyword">foreach</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">ConvertTo-ProductEntity</span> <span class="token operator">-</span>RegKey <span class="token variable">$_</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="获取文件夹大小" tabindex="-1"><a class="header-anchor" href="#获取文件夹大小"><span>获取文件夹大小</span></a></h2><div class="language-powershell" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token variable">$startFolder</span> = <span class="token string">&quot;D:\\flutter&quot;</span></span>
<span class="line"><span class="token variable">$colItems</span> = <span class="token punctuation">(</span><span class="token function">Get-ChildItem</span> <span class="token variable">$startFolder</span>  <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>PSIsContainer <span class="token operator">-eq</span> <span class="token boolean">$True</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Sort-Object</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$i</span> in <span class="token variable">$colItems</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$subFolderItems</span> = <span class="token punctuation">(</span><span class="token function">Get-ChildItem</span> <span class="token variable">$i</span><span class="token punctuation">.</span>FullName <span class="token operator">-</span>recurse <span class="token punctuation">|</span> <span class="token function">Measure-Object</span> <span class="token operator">-</span>property length <span class="token operator">-</span>sum<span class="token punctuation">)</span></span>
<span class="line">    <span class="token variable">$FileSize</span>=<span class="token string">&quot;{0:N2}&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token variable">$subFolderItems</span><span class="token punctuation">.</span>sum <span class="token operator">/</span> 1GB<span class="token punctuation">)</span></span>
<span class="line">    <span class="token variable">$Unit</span>=<span class="token string">&#39;GB&#39;</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$FileSize</span> <span class="token operator">-lt</span> 1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$FileSize</span>=<span class="token string">&quot;{0:N2}&quot;</span> <span class="token operator">-</span>f <span class="token punctuation">(</span><span class="token variable">$subFolderItems</span><span class="token punctuation">.</span>sum <span class="token operator">/</span> 1MB<span class="token punctuation">)</span></span>
<span class="line">        <span class="token variable">$Unit</span>=<span class="token string">&#39;MB&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">write-host</span> <span class="token variable">$i</span><span class="token punctuation">.</span>FullName  <span class="token string">&#39; -- &#39;</span>  <span class="token variable">$FileSize</span>  <span class="token variable">$Unit</span> <span class="token operator">-</span>fore green</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre></div><h2 id="获取文件夹内的文件数量" tabindex="-1"><a class="header-anchor" href="#获取文件夹内的文件数量"><span>获取文件夹内的文件数量</span></a></h2><div class="language-powershell" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token namespace">[System.IO.Directory]</span>::GetFiles<span class="token punctuation">(</span><span class="token string">&quot;d:\\flutter&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;AllDirectories&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Count</span>
<span class="line"></span></code></pre></div><p>或者</p><div class="language-powershell" data-highlighter="prismjs" data-ext="powershell" data-title="powershell"><pre><code><span class="line"><span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token string">&quot;d:\\flutter&quot;</span> <span class="token operator">-</span>Force <span class="token operator">-</span>Recurse <span class="token operator">-</span>ErrorAction SilentlyContinue <span class="token punctuation">|</span></span>
<span class="line"> <span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>PSIsContainer <span class="token operator">-eq</span> <span class="token boolean">$false</span> <span class="token punctuation">}</span> <span class="token punctuation">|</span></span>
<span class="line"> <span class="token function">Measure-Object</span> <span class="token punctuation">|</span> </span>
<span class="line"> <span class="token function">Select-Object</span> <span class="token operator">-</span>ExpandProperty Count</span>
<span class="line"></span></code></pre></div>`,16)]))}const o=s(t,[["render",l]]),u=JSON.parse('{"path":"/windows-tutor/powershell/my-powershell.html","title":"我的ps配置","lang":"zh-CN","frontmatter":{"description":"我的ps配置 提示 查询 profile位置: $PROFILE 配置文件 克隆王道的文档 小爬虫 获取安装的软件 获取文件夹大小 获取文件夹内的文件数量 或者","head":[["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/windows-tutor/powershell/my-powershell.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"我的ps配置"}],["meta",{"property":"og:description","content":"我的ps配置 提示 查询 profile位置: $PROFILE 配置文件 克隆王道的文档 小爬虫 获取安装的软件 获取文件夹大小 获取文件夹内的文件数量 或者"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-05T06:29:50.000Z"}],["meta",{"property":"article:modified_time","content":"2025-02-05T06:29:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"我的ps配置\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-02-05T06:29:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yzqdev\\",\\"url\\":\\"http://www.yzqdev.top\\"}]}"]]},"headers":[{"level":2,"title":"配置文件","slug":"配置文件","link":"#配置文件","children":[]},{"level":2,"title":"克隆王道的文档","slug":"克隆王道的文档","link":"#克隆王道的文档","children":[]},{"level":2,"title":"小爬虫","slug":"小爬虫","link":"#小爬虫","children":[]},{"level":2,"title":"获取安装的软件","slug":"获取安装的软件","link":"#获取安装的软件","children":[]},{"level":2,"title":"获取文件夹大小","slug":"获取文件夹大小","link":"#获取文件夹大小","children":[]},{"level":2,"title":"获取文件夹内的文件数量","slug":"获取文件夹内的文件数量","link":"#获取文件夹内的文件数量","children":[]}],"git":{"createdTime":1647861419000,"updatedTime":1738736990000,"contributors":[{"name":"yzqdev","username":"yzqdev","email":"yzqdev@outlook.com","commits":12,"url":"https://github.com/yzqdev"}]},"readingTime":{"minutes":0.34,"words":103},"filePathRelative":"windows-tutor/powershell/my-powershell.md","localizedDate":"2022年3月21日","autoDesc":true}');export{o as comp,u as data};
