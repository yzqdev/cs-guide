import{_ as s,c as a,a as p,o as t}from"./app-B6vXTniy.js";const e={};function o(l,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h1 id="发送邮件" tabindex="-1"><a class="header-anchor" href="#发送邮件"><span>发送邮件</span></a></h1><p>设置outlook的地址<br><a href="https://support.microsoft.com/zh-cn/office/outlook-com-%E7%9A%84-pop-imap-%E5%92%8C-smtp-%E8%AE%BE%E7%BD%AE-d088b986-291d-42b8-9564-9c414e2aa040" target="_blank" rel="noopener noreferrer">outlook设置</a></p><p>imap是双向协议,可以接受邮件可以发送邮件,pop是接受邮件,smtp是发送邮件</p><div class="language-python" data-highlighter="prismjs" data-ext="py"><pre><code class="language-python"><span class="line">conf <span class="token operator">=</span> ConnectionConfig<span class="token punctuation">(</span>MAIL_USERNAME<span class="token operator">=</span><span class="token string">&quot;Microsoft@outlook.com&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_PASSWORD<span class="token operator">=</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_FROM<span class="token operator">=</span><span class="token string">&quot;Microsoft@outlook.com&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_PORT<span class="token operator">=</span><span class="token number">587</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_SERVER<span class="token operator">=</span><span class="token string">&quot;smtp-mail.outlook.com&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_FROM_NAME<span class="token operator">=</span><span class="token string">&quot;Microsoft&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_TLS<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span></span>
<span class="line">                        MAIL_SSL<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span></span>
<span class="line">                        USE_CREDENTIALS<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span></span>
<span class="line">                        VALIDATE_CERTS<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code class="language-python"><span class="line"><span class="token keyword">import</span> smtplib</span>
<span class="line"><span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText</span>
<span class="line"><span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">send_outlook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;</span>
<span class="line">    send 163 email</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 发件人的邮箱账号</span></span>
<span class="line">    sender <span class="token operator">=</span> <span class="token string">&quot;111111@outlook.com&quot;</span></span>
<span class="line">    <span class="token comment"># 发件人的邮箱密码（注意：这里是授权码，不是登录密码）</span></span>
<span class="line">    password <span class="token operator">=</span> <span class="token string">&quot;1111111&quot;</span></span>
<span class="line">    <span class="token comment"># 收件人的邮箱账号</span></span>
<span class="line">    receiver <span class="token operator">=</span> <span class="token string">&quot;1111111@11.com&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 邮件主题</span></span>
<span class="line">    subject <span class="token operator">=</span> <span class="token string">&quot;这是邮件主题&quot;</span></span>
<span class="line">    <span class="token comment"># 邮件正文</span></span>
<span class="line">    message <span class="token operator">=</span> <span class="token string">&quot;这是邮件正文&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 创建邮件对象</span></span>
<span class="line">    msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">&quot;plain&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    msg<span class="token punctuation">[</span><span class="token string">&quot;Subject&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    msg<span class="token punctuation">[</span><span class="token string">&quot;From&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sender</span>
<span class="line">    msg<span class="token punctuation">[</span><span class="token string">&quot;To&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> receiver</span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 发送邮件</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        server <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span></span>
<span class="line">            <span class="token string">&quot;smtp-mail.outlook.com&quot;</span><span class="token punctuation">,</span> <span class="token number">587</span></span>
<span class="line">        <span class="token punctuation">)</span>  <span class="token comment"># 根据你的邮箱服务器进行修改</span></span>
<span class="line">        server<span class="token punctuation">.</span>starttls<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># server.connect()</span></span>
<span class="line"></span>
<span class="line">        server<span class="token punctuation">.</span>login<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> password<span class="token punctuation">)</span></span>
<span class="line">        server<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> <span class="token punctuation">[</span>receiver<span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        server<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;邮件发送成功&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;邮件发送失败&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    send_outlook<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)])])}const i=s(e,[["render",o]]),u=JSON.parse('{"path":"/python-tutor/python-tips/send-email.html","title":"发送邮件","lang":"zh-CN","frontmatter":{"description":"发送邮件 设置outlook的地址 outlook设置 imap是双向协议,可以接受邮件可以发送邮件,pop是接受邮件,smtp是发送邮件","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"发送邮件\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-08-11T12:26:49.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yzqdev\\",\\"url\\":\\"http://www.yzqdev.top\\"}]}"],["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/python-tutor/python-tips/send-email.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"发送邮件"}],["meta",{"property":"og:description","content":"发送邮件 设置outlook的地址 outlook设置 imap是双向协议,可以接受邮件可以发送邮件,pop是接受邮件,smtp是发送邮件"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-11T12:26:49.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-11T12:26:49.000Z"}]]},"git":{"createdTime":1647861419000,"updatedTime":1723379209000,"contributors":[{"name":"yzqdev","username":"yzqdev","email":"yzqdev@outlook.com","commits":4,"url":"https://github.com/yzqdev"}]},"readingTime":{"minutes":0.84,"words":253},"filePathRelative":"python-tutor/python-tips/send-email.md","autoDesc":true}');export{i as comp,u as data};
