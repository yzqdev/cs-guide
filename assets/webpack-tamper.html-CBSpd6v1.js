import{_ as n,c as a,a as p,o as e}from"./app-B6vXTniy.js";const t={};function o(l,s){return e(),a("div",null,[...s[0]||(s[0]=[p(`<h1 id="webpack开发油猴脚本" tabindex="-1"><a class="header-anchor" href="#webpack开发油猴脚本"><span>webpack开发油猴脚本</span></a></h1><h2 id="第一种-直接webpack-watch-有缓存-不推荐" tabindex="-1"><a class="header-anchor" href="#第一种-直接webpack-watch-有缓存-不推荐"><span>第一种,直接<code>webpack --watch</code> (有缓存,不推荐)</span></a></h2><ol><li>webpack --watch 打包 <code>dist/simple.user.js</code></li><li>在暴力猴里面使用<code>//@require file://xx/dist/simple.user.js</code></li></ol><p>这个方法有缺陷,@require加载的脚本会有缓存,需要好久脚本内容才会改变</p><p>https://stackoverflow.com/questions/30109626/how-do-i-prevent-require-from-caching-external-js-scripts</p><h2 id="第二种-使用webpack-dev-server-时间戳" tabindex="-1"><a class="header-anchor" href="#第二种-使用webpack-dev-server-时间戳"><span>第二种,使用webpack-dev-server+时间戳</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">{  </span>
<span class="line">  &quot;name&quot;: &quot;webpack-simple&quot;,  </span>
<span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,  </span>
<span class="line">  &quot;license&quot;: &quot;MIT&quot;,  </span>
<span class="line">  &quot;scripts&quot;: {  </span>
<span class="line">    &quot;dev&quot;: &quot;dotenv -v NODE_OPTIONS=&#39;--import=tsx/esm&#39; --  webpack serve --watch --config webpack.dev.mts&quot;,  </span>
<span class="line">    &quot;build&quot;: &quot;webpack &quot;  </span>
<span class="line">  },  </span>
<span class="line">  &quot;devDependencies&quot;: {  </span>
<span class="line">    &quot;@types/node&quot;: &quot;^20.12.7&quot;,  </span>
<span class="line">    &quot;clean-webpack-plugin&quot;: &quot;^4.0.0&quot;,  </span>
<span class="line">    &quot;css-loader&quot;: &quot;^7.1.1&quot;,  </span>
<span class="line">    &quot;html-webpack-plugin&quot;: &quot;^5.6.0&quot;,  </span>
<span class="line">    &quot;html-webpack-template&quot;: &quot;^6.2.0&quot;,  </span>
<span class="line">    &quot;mini-css-extract-plugin&quot;: &quot;latest&quot;,  </span>
<span class="line">    &quot;prettier&quot;: &quot;^3.2.5&quot;,  </span>
<span class="line">    &quot;sass&quot;: &quot;^1.76.0&quot;,  </span>
<span class="line">    &quot;sass-loader&quot;: &quot;^14.2.1&quot;,  </span>
<span class="line">    &quot;style-loader&quot;: &quot;^4.0.0&quot;,  </span>
<span class="line">    &quot;terser-webpack-plugin&quot;: &quot;^5.3.10&quot;,  </span>
<span class="line">    &quot;ts-loader&quot;: &quot;^9.5.1&quot;,  </span>
<span class="line">    &quot;tslib&quot;: &quot;^2.6.2&quot;,  </span>
<span class="line">    &quot;tsx&quot;: &quot;^4.8.2&quot;,  </span>
<span class="line">    &quot;typescript&quot;: &quot;^5.4.5&quot;,  </span>
<span class="line">    &quot;webpack&quot;: &quot;^5.91.0&quot;,  </span>
<span class="line">    &quot;webpack-cli&quot;: &quot;^5.1.4&quot;,  </span>
<span class="line">    &quot;webpack-dev-middleware&quot;: &quot;^7.2.1&quot;,  </span>
<span class="line">    &quot;webpack-dev-server&quot;: &quot;^5.0.4&quot;,  </span>
<span class="line">    &quot;webpack-hot-middleware&quot;: &quot;^2.26.1&quot;,  </span>
<span class="line">    &quot;webpack-merge&quot;: &quot;^5.10.0&quot;  </span>
<span class="line">  }  </span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后<code>nr dev</code> 脚本内容就在<code>http://localhost:9000/simple.bundle.js</code> 此时需要再暴力猴脚本内部写下如下代码,使用时间戳避免缓存</p><div class="language-typescript" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">const</span> script<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;script&#39;</span><span class="token punctuation">)</span></span>
<span class="line">script<span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token string">&#39;http://localhost:9000/simple.bundle.js?ts=&#39;</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>init<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre></div><h2 id="第三种webpack-userscript" tabindex="-1"><a class="header-anchor" href="#第三种webpack-userscript"><span>第三种<code>webpack-userscript</code></span></a></h2><p>package.json</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span>  </span>
<span class="line">  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-script&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MIT&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dotenv -v NODE_ENV=development -v NODE_OPTIONS=&#39;--import=tsx/esm&#39; --  webpack serve  --config webpack.dev.mts&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dotenv -v NODE_ENV=production -v NODE_OPTIONS=&#39;--import=tsx/esm&#39; --  webpack   --config webpack.prod.mts&quot;</span>  </span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">    <span class="token property">&quot;@types/node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^20.12.7&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;clean-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;css-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.1.1&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;html-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.6.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;html-webpack-template&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.2.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;mini-css-extract-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;latest&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.5&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;sass&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.76.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;sass-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^14.2.1&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;style-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;terser-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.3.10&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;ts-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^9.5.1&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;tslib&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.6.2&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;tsx&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.8.2&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;typescript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.4.5&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.91.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.1.4&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack-dev-middleware&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.2.1&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack-dev-server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.4&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack-hot-middleware&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.26.1&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack-merge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.10.0&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token property">&quot;webpack-userscript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.2&quot;</span>  </span>
<span class="line">  <span class="token punctuation">}</span>  </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>webpack.base.mts</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">&quot;node:path&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>HeadersProps<span class="token punctuation">,</span> UserscriptPlugin<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;webpack-userscript&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>VueLoaderPlugin<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>fileURLToPath<span class="token punctuation">,</span> pathToFileURL<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;node:url&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line">  </span>
<span class="line"><span class="token keyword">const</span> __dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">const</span> dev <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">==</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> Components <span class="token keyword">from</span> <span class="token string">&quot;unplugin-vue-components/webpack&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>ElementPlusResolver<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;unplugin-vue-components/resolvers&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> AutoImport <span class="token keyword">from</span> <span class="token string">&quot;unplugin-auto-import/webpack&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line">   </span>
<span class="line"><span class="token keyword">const</span> conf<span class="token operator">:</span> webpack<span class="token punctuation">.</span>Configuration <span class="token operator">=</span> <span class="token punctuation">{</span>  </span>
<span class="line">    entry<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">        usescriptPlus<span class="token operator">:</span> <span class="token string">&quot;./src/main.ts&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    output<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">        clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  </span>
<span class="line">        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">        filename<span class="token operator">:</span> <span class="token string">&quot;[name].user.js&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    resolve<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">        extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.tsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    module<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">        rules<span class="token operator">:</span> <span class="token punctuation">[</span>  </span>
<span class="line">            <span class="token punctuation">{</span>  </span>
<span class="line">                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.ts$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                use<span class="token operator">:</span> <span class="token punctuation">[</span>  </span>
<span class="line">                    <span class="token punctuation">{</span>  </span>
<span class="line">                        loader<span class="token operator">:</span> <span class="token string">&quot;ts-loader&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">                        options<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">                            transpileOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  </span>
<span class="line">                            appendTsSuffixTo<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">                        <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">                <span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">{</span>  </span>
<span class="line">                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                loader<span class="token operator">:</span> <span class="token string">&quot;vue-loader&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">                options<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">                    shadowMode<span class="token operator">:</span> <span class="token boolean">true</span>  </span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">{</span>  </span>
<span class="line">                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token operator">:</span> <span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">{</span>  </span>
<span class="line">                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>loader<span class="token operator">:</span> <span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">{</span>  </span>
<span class="line">                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(png|jpe?g|gif|svg)(\\?.*)?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                type<span class="token operator">:</span> <span class="token string">&quot;asset/inline&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">{</span>  </span>
<span class="line">                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(woff2?|eot|ttf|otf)(\\?.*)?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                type<span class="token operator">:</span> <span class="token string">&quot;asset/inline&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    externals<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">        vue<span class="token operator">:</span> <span class="token string">&#39;Vue&#39;</span><span class="token punctuation">,</span>  </span>
<span class="line">        dayjs<span class="token operator">:</span> <span class="token string">&quot;dayjs&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token string-property property">&#39;element-plus&#39;</span><span class="token operator">:</span><span class="token string">&quot;ElementPlus&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token string-property property">&quot;psl&quot;</span><span class="token operator">:</span><span class="token string">&quot;psl&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token string-property property">&#39;vue-i18n&#39;</span><span class="token operator">:</span><span class="token string">&#39;VueI18n&#39;</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token string-property property">&#39;@element-plus/icons-vue&#39;</span><span class="token operator">:</span><span class="token string">&#39;ElementPlusIconsVue&#39;</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>  </span>
<span class="line">        <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  </span>
<span class="line">  </span>
<span class="line">            resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">ElementPlusResolver</span><span class="token punctuation">(</span><span class="token punctuation">{</span>importStyle<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token function">Components</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  </span>
<span class="line">            resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">ElementPlusResolver</span><span class="token punctuation">(</span><span class="token punctuation">{</span>importStyle<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token keyword">new</span> <span class="token class-name">UserscriptPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  </span>
<span class="line">  </span>
<span class="line">            <span class="token function">headers</span><span class="token punctuation">(</span>original<span class="token operator">:</span> HeadersProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>  </span>
<span class="line">                original<span class="token punctuation">.</span>grant <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;GM.setValue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  </span>
<span class="line">               original<span class="token punctuation">.</span>resource<span class="token operator">=</span><span class="token punctuation">{</span>  </span>
<span class="line">                   <span class="token string-property property">&#39;element&#39;</span><span class="token operator">:</span> <span class="token string">&#39;https://registry.npmmirror.com/element-plus/2.7.2/files/dist/index.css&#39;</span><span class="token punctuation">,</span>  </span>
<span class="line">                   <span class="token string-property property">&#39;animate&#39;</span><span class="token operator">:</span><span class="token string">&#39;https://registry.npmmirror.com/animate.css/4.1.1/files/animate.min.css&#39;</span>  </span>
<span class="line">               <span class="token punctuation">}</span>  </span>
<span class="line">                original<span class="token punctuation">.</span><span class="token keyword">require</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;https://registry.npmmirror.com/vue/3.4.26/files/dist/vue.global.prod.js&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">                    <span class="token string">&quot;https://registry.npmmirror.com/vue-i18n/9.13.1/files/dist/vue-i18n.global.prod.js&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">                    <span class="token string">&#39;https://registry.npmmirror.com/psl/1.9.0/files/dist/psl.min.js&#39;</span><span class="token punctuation">,</span>  </span>
<span class="line">  </span>
<span class="line">                    <span class="token string">&#39;https://registry.npmmirror.com/dayjs/1.11.11/files/dayjs.min.js&#39;</span><span class="token punctuation">,</span>  </span>
<span class="line">                <span class="token string">&quot;https://registry.npmmirror.com/element-plus/2.7.2/files/dist/index.full.min.js&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">                    <span class="token string">&#39;https://registry.npmmirror.com/@element-plus/icons-vue/2.3.1/files/dist/index.iife.js&#39;</span>  </span>
<span class="line">  </span>
<span class="line">            <span class="token punctuation">]</span>  </span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>dev<span class="token punctuation">)</span> <span class="token punctuation">{</span>  </span>
<span class="line">                    <span class="token comment">// original.updateURL=&quot;https://github.com/trim21/webpack-userscript-template&quot;  </span></span>
<span class="line">  </span>
<span class="line">                    <span class="token keyword">return</span> <span class="token punctuation">{</span>  </span>
<span class="line">                        <span class="token operator">...</span>original<span class="token punctuation">,</span>  </span>
<span class="line">                        version<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>original<span class="token punctuation">.</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-build.[buildNo]</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>  </span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">;</span>  </span>
<span class="line">                <span class="token punctuation">}</span>  </span>
<span class="line">  </span>
<span class="line">                <span class="token keyword">return</span> original<span class="token punctuation">;</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">            proxyScript<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">                <span class="token comment">// http://localhost:9020/userscriptPlus.user.js  </span></span>
<span class="line">                baseURL<span class="token operator">:</span> <span class="token function">pathToFileURL</span><span class="token punctuation">(</span><span class="token string">&quot;./dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>href <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">                <span class="token comment">// baseURL: &quot;http://localhost:9010&quot;,  </span></span>
<span class="line">                filename<span class="token operator">:</span> <span class="token string">&quot;[basename].proxy.user.js&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> conf<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>webpack.dev.mts</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;webpack-merge&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> base <span class="token keyword">from</span> <span class="token string">&quot;./webpack.base.mjs&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">&quot;node:path&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;node:url&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&quot;webpack-dev-server&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> styleText <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;node:util&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">HeadersProps</span><span class="token punctuation">,</span> UserscriptPlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;webpack-userscript&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">const</span> dev <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">==</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line">  </span>
<span class="line"><span class="token keyword">const</span> devConf <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> <span class="token punctuation">{</span>  </span>
<span class="line">  mode<span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">  </span>
<span class="line">  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">    allowedHosts<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>  </span>
<span class="line">    hot<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  </span>
<span class="line">    devMiddleware<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">      writeToDisk<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    client<span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">      overlay<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  </span>
<span class="line">      progress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  </span>
<span class="line">      reconnect<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">  </span>
<span class="line">    <span class="token keyword">static</span><span class="token operator">:</span> <span class="token punctuation">{</span>  </span>
<span class="line">      directory<span class="token operator">:</span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">    port<span class="token operator">:</span> <span class="token number">9020</span><span class="token punctuation">,</span>  </span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>  </span>
<span class="line">  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  </span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> devConf<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>如何hot reload</strong></p><h3 id="对于暴力猴" tabindex="-1"><a class="header-anchor" href="#对于暴力猴"><span>对于暴力猴</span></a></h3><ol><li>直接用浏览器打开本地js文件,然后跟踪外部编辑</li><li>网页打开<code>http://127.0.0.1:9010/simple.user.js</code>,在暴力猴安装界面选择 <code>跟踪外部编辑</code>,不要 关闭外部界面即可,关闭后需要重新打开上面的链接 这里使用的@require file:// 所以不会cache</li></ol><h3 id="对于油猴" tabindex="-1"><a class="header-anchor" href="#对于油猴"><span>对于油猴</span></a></h3><p>手动复制<code>dist/simple.proxy.user.js</code>里面的内容,创建新的脚本,然后页面刷新即可</p>`,21)])])}const i=n(t,[["render",o]]),u=JSON.parse('{"path":"/frontend/chrome-plugins/webpack-tamper.html","title":"webpack开发油猴脚本","lang":"zh-CN","frontmatter":{"description":"webpack开发油猴脚本 第一种,直接webpack --watch (有缓存,不推荐) webpack --watch 打包 dist/simple.user.js 在暴力猴里面使用//@require file://xx/dist/simple.user.js 这个方法有缺陷,@require加载的脚本会有缓存,需要好久脚本内容才会改变 http...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"webpack开发油猴脚本\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-08T13:17:19.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yzqdev\\",\\"url\\":\\"http://www.yzqdev.top\\"}]}"],["meta",{"property":"og:url","content":"https://yzqdev.github.io/cs-guide/cs-guide/frontend/chrome-plugins/webpack-tamper.html"}],["meta",{"property":"og:site_name","content":"cs-guide"}],["meta",{"property":"og:title","content":"webpack开发油猴脚本"}],["meta",{"property":"og:description","content":"webpack开发油猴脚本 第一种,直接webpack --watch (有缓存,不推荐) webpack --watch 打包 dist/simple.user.js 在暴力猴里面使用//@require file://xx/dist/simple.user.js 这个方法有缺陷,@require加载的脚本会有缓存,需要好久脚本内容才会改变 http..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-08T13:17:19.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-08T13:17:19.000Z"}]]},"git":{"createdTime":1714738880000,"updatedTime":1715174239000,"contributors":[{"name":"yzqdev","username":"yzqdev","email":"yzqdev@outlook.com","commits":2,"url":"https://github.com/yzqdev"}]},"readingTime":{"minutes":2.62,"words":785},"filePathRelative":"frontend/chrome-plugins/webpack-tamper.md","autoDesc":true}');export{i as comp,u as data};
